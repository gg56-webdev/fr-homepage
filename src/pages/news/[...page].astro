---
import i18next, { changeLanguage, t } from "i18next";
import { getPosts } from "@/api";
import Layout from "@/layouts/Layout.astro";
import NewsCard from "@/components/NewsCard.astro";
import { type GetStaticPathsOptions } from "astro";

changeLanguage("en");

export async function getStaticPaths({ paginate }: GetStaticPathsOptions) {
    const posts = await getPosts({ lang: i18next.language });
    return paginate(posts, { pageSize: 14 });
}
const { page } = Astro.props;
---

<Layout image="/og/news.jpg" title={t('seo.news.title')!} description={t('seo.news.description')!}>
  <div class="py-8 md:pb-24">
    <section class="mx-auto max-w-screen-lg p-2">
      <h1 class="mb-8 text-center text-4xl font-bold">{t('news.h1')}</h1>
      {
        page.data.length > 0 ? (
          <ul class="grid sm:grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 md:gap-6">
            {page.data.map((post) => {
              return (
                <li
                  data-scroll-animation
                  class:list={[
                    'sm:col-span-2',
                    {
                      'sm:first:col-span-2 md:first:col-span-4 lg:first:col-span-6 md:[&:nth-of-type(n+2):nth-of-type(-n+5)]:col-span-2 lg:[&:nth-of-type(n+2):nth-of-type(-n+5)]:col-span-3':
                        page.currentPage === 1,
                    },
                  ]}
                >
                  <NewsCard {post} />
                </li>
              );
            })}
          </ul>
        ) : (
          <p class="text-cyberLilac text-center">{t('news.no-news')}</p>
        )
      }
      {page.url.prev ? <a href={page.url.prev}>Previous</a> : null}
      {page.url.next ? <a href={page.url.next}>Next</a> : null}
    </section>
  </div>
</Layout>
